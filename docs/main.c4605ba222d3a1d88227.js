!function(t){function e(e){for(var s,o,r=e[0],l=e[1],c=e[2],d=0,f=[];d<r.length;d++)o=r[d],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&f.push(a[o][0]),a[o]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(t[s]=l[s]);for(u&&u(e);f.length;)f.shift()();return i.push.apply(i,c||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],s=!0,r=1;r<n.length;r++){var l=n[r];0!==a[l]&&(s=!1)}s&&(i.splice(e--,1),t=o(o.s=n[0]))}return t}var s={},a={0:0},i=[];function o(e){if(s[e])return s[e].exports;var n=s[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=s,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)o.d(n,s,function(e){return t[e]}.bind(null,s));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="";var r=window.webpackJsonp=window.webpackJsonp||[],l=r.push.bind(r);r.push=e,r=r.slice();for(var c=0;c<r.length;c++)e(r[c]);var u=l;i.push([121,1]),n()}({121:function(t,e,n){n(122),t.exports=n(309)},308:function(t,e,n){},309:function(t,e,n){"use strict";n.r(e),n.d(e,"firebase",(function(){return I}));n(308);function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var i=function t(e,n,i){s(this,t),a(this,"items",void 0),a(this,"listName",void 0),this.listName=e,this.items={},n&&(this.items.toBuy=n),i&&(this.items.purchased=i)},o=function t(e){s(this,t),a(this,"itemName",void 0),a(this,"quantity",1),a(this,"unit","pcs"),this.itemName=e};function r(t){return function(t){if(Array.isArray(t))return l(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return l(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,s=new Array(e);n<e;n++)s[n]=t[n];return s}var c={lists:function(t){var e=P.user.uid;D.innerHTML="";var n=T("button","add-list-btn");n.innerHTML="+",D.append(n),n.addEventListener("click",(function(t){t.preventDefault(),p.classList.add("modal_is-open"),h.focus(),v.addEventListener("submit",(function t(n){n.preventDefault(),I.database().ref("".concat(e,"/lists")).get().then((function(n){var s=n.val()||[],a=h.value,o=new i(a);s.unshift(o),console.log(s),I.database().ref("".concat(e,"/lists")).set(s),h.value="",v.removeEventListener("submit",t),p.classList.remove("modal_is-open")}))}))})),t.forEach((function(t,n){var s=T("div","list-elem"),a=t.items||{},i=a.toBuy||[],o=a.purchased||[],r=i.length||0,l=o.length||0,u=l+r,d='\n        <h2 class="list-elem__name">'.concat(t.listName,'</h2>\n        <span class="list-elem__counter">').concat(l," / ").concat(u,'</span>\n        <div class="list-elem__options">\n          <img src="./img/dots.svg" alt="" />\n    \n          <div class="list-elem__options-list">\n            <a href="#" class="list-elem__options-list-elem">Rename</a>\n            <a href="#" class="list-elem__options-list-elem">Delete</a>\n          </div>\n        </div>\n        <div class="list-elem__progress">\n          <div class="list-elem__progress_blue"></div>\n        </div>\n      ');s.innerHTML=d,s.querySelector(".list-elem__progress_blue").style.width=100*(l/u||1)+"%";var f=s.querySelector(".list-elem__options"),m=s.querySelector(".list-elem__options-list"),p=m.firstElementChild,v=m.lastElementChild;U(f,m,"list-elem__options-list"),D.insertAdjacentElement("beforeend",s),p.addEventListener("click",(function(s){function a(s){s.preventDefault(),t.listName!==y.value&&I.database().ref("".concat(e,"/lists/").concat(n,"/listName")).set(y.value),_.classList.remove("modal_is-open"),b.removeEventListener("submit",a)}s.preventDefault(),m.classList.remove("list-elem__options-list_is-open"),_.classList.add("modal_is-open"),y.value=t.listName,b.addEventListener("submit",a),g.addEventListener("click",(function(){_.classList.remove("modal_is-open"),b.removeEventListener("submit",a)})),_.addEventListener("click",(function(t){t.target.classList.contains("modal")&&(_.classList.remove("modal_is-open"),b.removeEventListener("submit",a))}))})),v.addEventListener("click",(function(s){s.preventDefault(),m.classList.remove("list-elem__options-list_is-open"),I.database().ref("".concat(e,"/lists")).get().then((function(t){var s=t.val()||[];s.splice(n,1),I.database().ref("".concat(e,"/lists")).set(s)})),I.database().ref("".concat(e,"/trash")).get().then((function(n){var s=n.val()||[];s.unshift(t),I.database().ref("".concat(e,"/trash")).set(s)}))})),s.addEventListener("click",(function t(e){e.target.closest(".list-elem__options")||(D.className="content list",c.list(n),s.removeEventListener("click",t))}))}))},list:function(t){var e=P.user.uid;I.database().ref("".concat(e,"/lists")).off(),I.database().ref("".concat(e,"/lists/").concat(t)).on("value",(function(n){var s=n.val(),a=s.listName,i=s.items,l=[],c=[];i&&(l=i.toBuy||[],c=i.purchased||[]),D.innerHTML='\n          <input type="text" class="shoplist__name" value="'.concat(a,'">\n          <form class="shoplist__add-item">\n            <label class="shoplist__add-input-label" for="add-item">+</label>\n            <input type="text" name="add-item" id="add-item" class="shoplist__add-input" placeholder="Add item" />\n          </form>\n        ');var u=D.querySelector(".shoplist__name");u.addEventListener("change",(function(){I.database().ref("".concat(e,"/lists/").concat(t,"/listName")).set(u.value)}));var d=D.querySelector(".shoplist__add-item"),f=d.querySelector(".shoplist__add-input");if(d.addEventListener("submit",(function(n){n.preventDefault();var s=new o(f.value);l.unshift(s),I.database().ref("".concat(e,"/lists/").concat(t,"/items/toBuy")).set(l)})),l.length){var m=T("ul","shoplist__to-buy");l.forEach((function(n,s){var a=T("li","shoplist__item");a.innerHTML='\n              <div class="shoplist__item-name">\n                <input class="checkbox" type="checkbox" name="add-item-'.concat(s,'" id="add-item-').concat(s,'" />\n                <label class="checkbox__label" for="add-item-').concat(s,'"></label>\n                <span class="shoplist__item-name-text">').concat(n.itemName,'</span>\n                <button class="drop">\n                  <span></span>\n                </button>\n              </div>\n              <div class="shoplist__item-info">\n                <button class="shoplist__item-quantity-btn shoplist__item-quantity-btn_minus">-</button>\n                <span class="shoplist__item-quantity">').concat(n.quantity,'</span>\n                <button class="shoplist__item-quantity-btn shoplist__item-quantity-btn_plus">+</button>\n                <select name="unit-1" id="unit-1" class="shoplist__item-unit">\n                  <option value="pcs">pcs</option>\n                  <option value="kg">kg</option>\n                  <option value="gr">gr</option>\n                  <option value="lit">lit</option>\n                </select>\n                <button class="shoplist__item-delete">\n                  <img src="./img/trash.svg" alt="" class="shoplist__item-delete-img" />\n                </button>\n              </div>\n            '),r(a.querySelectorAll("option")).map((function(t){t.innerHTML===n.unit&&t.setAttribute("selected","selected")})),a.querySelector(".shoplist__item-delete").addEventListener("click",(function(n){n.preventDefault(),l.splice(s,1),I.database().ref("".concat(e,"/lists/").concat(t,"/items/toBuy")).set(l)})),m.insertAdjacentElement("beforeend",a)})),D.insertAdjacentElement("beforeend",m)}if(c.length){var p=T("ul","shoplist__purchase");c.forEach((function(n,s){var a=T("li","shoplist__item shoplist__item_purchase"),i=l.length+s;a.innerHTML='\n              <div class="shoplist__item-name">\n                <input class="checkbox" type="checkbox" checked name="add-item-'.concat(i,'" id="add-item-').concat(i,'" />\n                <label class="checkbox__label" for="add-item-').concat(i,'"></label>\n                <span class="shoplist__item-name-text">').concat(n.itemName,'</span>\n              </div>\n              <div class="shoplist__item-info">\n                <span class="shoplist__item-quantity_purchase">').concat(n.quantity,'</span>\n                <span class="shoplist__item-unit">').concat(n.unit,'</span>\n                <button class="shoplist__item-delete">\n                  <img src="./img/trash.svg" alt="" class="shoplist__item-delete-img" />\n                </button>\n              </div>\n            '),a.querySelector(".shoplist__item-delete").addEventListener("click",(function(n){n.preventDefault(),c.splice(s,1),I.database().ref("".concat(e,"/lists/").concat(t,"/items/purchased")).set(c)})),p.insertAdjacentElement("beforeend",a)})),D.insertAdjacentElement("beforeend",p)}}))},trash:function(t){var e=P.user.uid;D.innerHTML="",t.forEach((function(t,n){var s=T("div","list-elem"),a=t.items||{},i=a.toBuy||[],o=a.purchased||[],r=i.length||0,l=o.length||0,c=l+r,u='\n        <h2 class="list-elem__name">\n        '.concat(t.listName,'\n        </h2>\n        <span class="list-elem__counter">').concat(l," / ").concat(c,'</span>\n        <div class="trash-btns">\n          <button class="trash-btn">restore</button>\n          <button class="trash-btn">delete</button>\n        </div>\n      ');s.innerHTML=u;var d=s.querySelector(".trash-btns"),f=d.firstElementChild,m=d.lastElementChild;D.insertAdjacentElement("beforeend",s),f.addEventListener("click",(function(s){s.preventDefault(),I.database().ref("".concat(e,"/trash")).get().then((function(t){var s=t.val()||[];s.splice(n,1),I.database().ref("".concat(e,"/trash")).set(s)})),I.database().ref("".concat(e,"/lists")).get().then((function(n){var s=n.val()||[];s.unshift(t),I.database().ref("".concat(e,"/lists")).set(s)}))})),m.addEventListener("click",(function(t){t.preventDefault(),I.database().ref("".concat(e,"/trash")).get().then((function(t){var s=t.val()||[];s.splice(n,1),I.database().ref("".concat(e,"/trash")).set(s)}))}))}))},settings:function(t){}},u=/^\w+@\w+\.\w{2,}$/,d=(document.querySelector(".burger-menu"),document.querySelector(".header__authorization")),f=document.querySelector(".user"),m=document.querySelector(".sidebar"),p=document.querySelector(".modal-new-list"),v=p.querySelector(".modal__form"),h=p.querySelector(".modal__input"),_=document.querySelector(".modal-rename-list"),b=_.querySelector(".modal__form"),y=_.querySelector(".modal__input"),g=_.querySelector(".modal__btns").firstElementChild,L=document.querySelector(".authorization"),E=L.querySelector(".authorization__form"),S=E.querySelector(".authorization__close"),q=E.querySelector(".authorization__forget"),k=E.querySelector(".authorization__input-email"),w=E.querySelector(".authorization__input-pass"),N=E.querySelector(".authorization__btn_sign-up"),j=E.querySelector(".authorization__btn_sign-in"),A=document.querySelector(".log-out"),O=document.querySelector(".log-out__email"),x=A.querySelector(".log-out__btn"),M=A.querySelector(".log-out__close-btn"),D=document.querySelector(".content");function T(t,e){var n=document.createElement(t);return n.className=e,n}function U(t,e,n){t.addEventListener("click",(function s(){e.classList.add("".concat(n,"_is-open")),t.removeEventListener("click",s),setTimeout((function(){document.addEventListener("click",(function a(i){var o=i.target;o===e||o.closest(".".concat(n))&&!o.classList.contains("".concat(n,"__close-btn"))||(e.classList.remove("".concat(n,"_is-open")),document.removeEventListener("click",a),t.addEventListener("click",s))}))}))}))}function z(){var t=P.user.uid;I.database().ref("".concat(t,"/lists")).get().then((function(e){e.val().forEach((function(e,n){I.database().ref("".concat(t,"/lists/").concat(n)).off()}))}))}var P={user:null,initUser:function(){var t=this;I.auth().onAuthStateChanged((function(){if(t.user=I.auth().currentUser,console.log(P.user),P.user?(d.style.display="none",f.style.display="",L.classList.remove("authorization_is-open")):(console.log("no setUser"),d.style.display="",f.style.display="none"),t.user){t.user.displayName&&t.updateUserInfo();var e=P.user.uid;D.classList.add("lists"),I.database().ref("".concat(e,"/lists")).on("value",(function(t){var e=t.val()||[];D.classList.contains("lists")&&c.lists(e)}))}else D.className="content"}))},signIn:function(t,e){if(!u.test(t))return alert("Email is not valid");I.auth().signInWithEmailAndPassword(t,e).catch((function(t){var e=t.code,n=t.message;"auth/wrong-password"===e?alert("Wrong password"):"auth/user-not-found"==e?alert("User not found"):alert(n)}))},signUp:function(t,e){var n=this;u.test(t)?t.trim()&&e.trim()?I.auth().createUserWithEmailAndPassword(t,e).then((function(e){var s=t.substring(0,t.indexOf("@"));I.auth().currentUser.updateProfile({displayName:s}).then((function(){n.updateUserInfo();var e=[];I.database().ref("users").get().then((function(n){(e=n.val()||[]).push(t),I.database().ref("users").set(e)}))}))})).catch((function(t){var e=t.code,n=t.message;"auth/weak-password"===e?alert("Слабый пароль"):"auth/email-already-in-use"==e?alert("Этот email уже используется"):(console.log(t),console.log(e),console.log(n))})):alert("Введите даные"):alert("email is not valid")},logOut:function(){I.auth().signOut()},sendForget:function(t){if(!u.test(t))return alert("email is not valid");I.auth().sendPasswordResetEmail(t).then((function(){alert("Письмо отправлено")})).catch((function(t){"auth/user-not-found"==t.code?alert("User not found"):alert(t.message)}))},updateUserInfo:function(){f.innerHTML=this.user.displayName[0].toUpperCase(),O.innerHTML=this.user.email}},I=window.firebase;I.initializeApp({apiKey:"AIzaSyBWD1NHPb3KwMzsvX05WLUPqxWMgC2RLTw",authDomain:"buylist-b265a.firebaseapp.com",databaseURL:"https://buylist-b265a-default-rtdb.firebaseio.com",projectId:"buylist-b265a",storageBucket:"buylist-b265a.appspot.com",messagingSenderId:"753800425123",appId:"1:753800425123:web:c4e4e589ba986cf1511916"}),P.initUser(),d.addEventListener("click",(function(t){L.classList.add("authorization_is-open")})),L.addEventListener("click",(function(t){t.target===L&&L.classList.remove("authorization_is-open")})),S.addEventListener("click",(function(t){t.preventDefault(),t.target===S&&L.classList.remove("authorization_is-open")})),q.addEventListener("click",(function(t){t.preventDefault(),P.sendForget(k.value)})),N.addEventListener("click",(function(t){t.preventDefault(),P.signUp(k.value,w.value)})),U(f,A,"log-out"),x.addEventListener("click",(function(){A.classList.remove("log-out_is-open"),P.logOut()})),M.addEventListener("click",(function(){A.classList.remove("log-out_is-open")})),j.addEventListener("click",(function(t){t.preventDefault(),P.signIn(k.value,w.value)})),p.addEventListener("click",(function(t){t.target.classList.contains("modal")&&(p.classList.remove("modal_is-open"),p.querySelector(".modal__input").value="")})),m.addEventListener("click",(function(t){var e=t.target,n=P.user.uid;e.closest(".sidebar__btn-lists")&&(D.classList.contains("list")&&z(),D.className="content lists",I.database().ref("".concat(n,"/trash")).off(),I.database().ref("".concat(n,"/lists")).on("value",(function(t){var e=t.val()||[];c.lists(e)}))),e.closest(".sidebar__btn-trash")&&(D.classList.contains("list")&&z(),D.className="content trash",I.database().ref("".concat(n,"/lists")).off(),I.database().ref("".concat(n,"/trash")).on("value",(function(t){var e=t.val()||[];c.trash(e)}))),e.closest(".sidebar__btn-settings")&&c.settings}))}});